@use 'sass:color';

// https://www.youtube.com/watch?v=7KDlPgRUm6w&list=PLDCHtNttcDy8-TyJw6uyimX0pzeaWCiIA&index=8&ab_channel=TinSleeves

@font-face {
  font-family: ocr-a-extended;
  src: url('../public/fonts/OCR-A-EXT.ttf') format('opentype');
}

@property --rssi-num {
  syntax: '<integer>';
  initial-value: 69;
  inherits: false;
}

#retrofuturism {
  --primary-rgb: 199, 163, 20;
  --primary-hsl: hsl(48, 82%, 43%);
  --primary-rgb-TEST: rgb(199, 163, 20);

  color: rgb(var(--primary-rgb));
  font-family: 'ocr-a-extended';
  font-weight: bold;
  padding: 24px;

  .filled {
    color: var(--color-background) !important;
    background: rgb(var(--primary-rgb)) !important;
  }

  .bordered {
    border: 4px solid rgb(var(--primary-rgb));
  }

  .padding-sm {
    padding: 4px;
  }
  .padding-md {
    padding: 8px;
  }

  .vertical-center {
    display: flex;
    align-items: center;
  }

  .horizontal-center {
    display: flex;
    justify-content: center;
  }

  .info-window-heading-1 {
    border-bottom: 4px solid rgb(var(--primary-rgb));
  }

  .info-window-heading-2 {
    display: grid;
    grid-template-columns: 5fr 3fr;
    border-bottom: 4px solid rgb(var(--primary-rgb));
  }

  .horizontal-right {
    display: flex;
    justify-content: flex-end;
  }

  .with-footer {
    display: flex;
    flex-direction: column;
  }

  .footer {
    margin-top: auto;
  }

  .list-item {
    padding: 4px 8px;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    background: none;

    &:active,
    &:focus {
      outline: none;
      @extend .filled;
    }
  }

  .anim-blink {
    animation: blink 2s steps(2, start) infinite;
  }

  .overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;

    background: linear-gradient(
      rgb(var(--primary-rgb), 0.1),
      rgb(var(--primary-rgb), 0.1) 3px,
      transparent 3px,
      transparent 9px
    );
    background-size: 100% 7px;
    // animation: pan-overlay 60s infinite linear;
  }

  .container {
    display: grid;
    height: 100%;
    grid-template-columns: minmax(0, 5fr) minmax(0, 3fr);
    grid-template-rows: minmax(0, 0.5fr) minmax(0, 8fr);
    gap: 24px 24px;
    grid-auto-flow: row;
    grid-template-areas:
      'banner banner'
      'left right';
  }

  .banner {
    grid-area: banner;
  }

  .left {
    display: grid;
    grid-template-columns: 1fr;
    grid-template-rows: 2fr 1fr;
    gap: 24px 24px;
    grid-auto-flow: row;
    grid-template-areas:
      'planet'
      'transmissions-n-broadcast';
    grid-area: left;
  }

  .planet {
    grid-area: planet;
  }

  .transmissions-n-broadcast {
    display: grid;
    grid-template-columns: 2.5fr 1fr;
    grid-template-rows: 1fr;
    gap: 24px 24px;
    grid-auto-flow: row;
    grid-template-areas: 'transmissions broadcast';
    grid-area: transmissions-n-broadcast;
  }

  .broadcast {
    grid-area: broadcast;
  }

  .transmissions {
    display: grid;
    grid-template-columns: 1fr;
    grid-template-rows: 1fr 1fr;
    gap: 24px 24px;
    grid-auto-flow: row;
    grid-template-areas:
      '.'
      '.';
    grid-area: transmissions;
  }

  .right {
    display: grid;
    grid-template-columns: 1fr;
    grid-template-rows: 3fr 0.5fr 4.5fr;
    gap: 24px 24px;
    grid-auto-flow: row;
    grid-template-areas:
      'sat-data-link'
      'upload'
      'fuses';
    grid-area: right;
  }

  .sat-data-link {
    grid-area: sat-data-link;
    overflow: hidden; // Code in the #console might overflow
  }

  #console {
    display: flex;
    flex-direction: column;
    height: 100%;
    padding: 8px;
    overflow: hidden;

    .text-container {
      margin-top: auto;

      // Just show the last 11 rows of text
      .console-text:nth-last-child(-n + 11) {
        display: block;
      }

      .console-text {
        display: none;
        overflow: hidden;
        white-space: pre;
        animation: typing calc(var(--anim-time) * 1ms) steps(var(--nr-chars), end);

        &:empty {
          height: 1em;
        }

        @keyframes typing {
          from {
            width: 0;
          }
          to {
            // Works because the OCR-A font is monospaced
            width: calc(var(--nr-chars) * 1ch);
          }
        }
      }
    }
  }

  .upload {
    grid-area: upload;
  }

  .fuses {
    grid-area: fuses;
  }

  #transmission-1,
  #transmission-2 {
    display: flex;
    flex-direction: column;
  }

  #scan-container {
    position: relative;
    height: 100%;

    #scan-squeegee {
      width: 4px;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      background: rgb(var(--primary-rgb));
      animation: squeegee 5s ease-in-out infinite alternate;
    }

    #scan-canvas {
      position: absolute;
      top: 0;
      left: 0;
    }
  }

  #tiles-container {
    flex: 1;
    display: grid;
    grid-template-columns: repeat(var(--tile-columns), 1fr);
    grid-template-rows: repeat(var(--tile-rows), 1fr);

    .tile {
      border: 2px solid var(--color-background);
      // "CSS variable to SASS color" to use CSS relative colors since i don't like sass variables
      $color: 'hsl(from var(--primary-hsl) h s l / var(--tile-opacity))';
      background: unquote($color);

      &:hover {
        border-color: rgb(var(--primary-rgb));
      }
    }
  }

  #rssi {
    animation: rssi-counter 5s infinite alternate cubic-bezier(0.42, 1.19, 0.68, -0.34);
    counter-reset: num var(--rssi-num);

    &::after {
      content: counter(num);
    }
  }

  @keyframes rssi-counter {
    from {
      --rssi-num: 69;
    }
    to {
      --rssi-num: 83;
    }
  }

  @keyframes pan-overlay {
    from {
      background-position: 0% 0%;
    }
    to {
      background-position: 0% -100%;
    }
  }

  @keyframes blink {
    to {
      visibility: hidden;
    }
  }

  @keyframes squeegee {
    to {
      left: calc(100% - 4px);
    }
  }
}
